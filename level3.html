<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Waste Sorting Game</title>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: flex-start;
    }

    .container {
        display: flex;
        align-items: flex-start;
    }

    .waste-container {
        margin-left: 20px;
    }

    .waste {
        width: 100px;
        height: 100px;
        border: 2px solid black;
        margin: 10px;
        display: inline-block;
        cursor: pointer;
        overflow: hidden; /* Ensure images fit within the container */
    }

    .waste img {
        width: 100%; /* Make the image fill the container */
        height: 100%; /* Make the image fill the container */
    }

    .pile-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-right: 20px;
    }

    .pile {
        position: relative;
        width: 220px; /* Increased width to accommodate the border and padding */
        height: 220px; /* Increased height to accommodate the border and padding */
        border: 2px solid black;
        margin: 10px;
        padding: 10px;
        overflow: auto;
    }

    .pile::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 10px; /* Width of the growth marker */
        height: 0; /* Initial height of the growth marker */
        background-color: green; /* Color of the growth marker */
        transition: height 0.5s; /* Smooth transition for height changes */
    }

    .hovered {
        border: 2px dashed red;
    }

    .dragging {
        opacity: 0.5;
    }

    .game-over-message {
        display: none;
        font-weight: bold;
        color: green;
    }

    .waste-name {
        font-size: 10px;
        color: blue;
    }

    /* Add styles for the point box and timer */
    .game-info {
        position: fixed;
        bottom: 10px;
        left: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    #points {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
    }

    #timer {
        font-size: 18px;
    }

    #try-again-button {
        display: none;
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
    }
</style>
</head>
<body>

<!-- Add the game info container for points and timer -->
<div class="game-info">
    <div id="points">Points: 0</div>
    <div id="timer">Time Left: 1:00</div>
    <button id="try-again-button">Try Again</button>
</div>

<div class="container">
    <div class="pile-container">
        <div class="pile" id="pile1">Biofuel Pile</div>
        <div class="growth-marker" id="biofuel-growth"></div>
        <div id="pile1_box" class="pile-box">
            <h3>BIOfuel Pile</h3>
            <div class="control-container">
                <label for="pile1-temp">Temperature:</label>
                <input id="pile1-temp" type="range" min="0" max="100" value="50">
            </div>
            <div class="control-container">
                <label for="pile1-pressure">Pressure:</label>
                <input id="pile1-pressure" type="range" min="0" max="100" value="50">
            </div>
        </div>
    </div>

    <div class="pile-container">
        <div class="pile" id="pile2">Plastic Pile</div>
        <div class="growth-marker" id="plastic-growth"></div>
        <div id="pile2_box" class="pile-box">
            <h3>Plastic Pile</h3>
            <div class="control-container">
                <label for="pile2-temp">Temperature:</label>
                <input id="pile2-temp" type="range" min="0" max="100" value="50">
            </div>
            <div class="control-container">
                <label for="pile2-pressure">Pressure:</label>
                <input id="pile2-pressure" type="range" min="0" max="100" value="50">
            </div>
        </div>
    </div>

    <div class="pile-container">
        <div class="pile" id="hazardous-pile">Hazardous Waste Pile</div>
        <div class="growth-marker" id="hazardous-growth"></div>
        <div id="hazardous-waste-box" class="pile-box">
            <h3>Hazardous Waste Disposal Pile</h3>
            <div class="control-container">
                <label for="hazardous-temp">Temperature:</label>
                <input id="hazardous-temp" type="range" min="0" max="100" value="50">
            </div>
            <div class="control-container">
                <label for="hazardous-pressure">Pressure:</label>
                <input id="hazardous-pressure" type="range" min="0" max="100" value="50">
            </div>
        </div>
    </div>

    <div class="waste-container">
        <div class="waste" id="wheat-straw" draggable="true" data-name="Wheat Straw" data-pile="pile1">
            <img src="Images/Level 3/Wheat straw.png" title="Wheat Straw">
        </div>
        <div class="waste" id="paper-waste" draggable="true" data-name="Paper Waste" data-pile="pile1">
            <img src="Images/Level 3/Paper waste.png" title="Paper Waste">
        </div>
        <div class="waste" id="algea" draggable="true" data-name="Algea" data-pile="pile1">
            <img src="Images/Level 3/Algea.png" title="Algea">
        </div>
        <div class="waste" id="food-waste" draggable="true" data-name="Food Waste" data-pile="pile1">
            <img src="Images/Level 3/Food waste.png" title="Food Waste">
        </div>

        <div class="waste" id="pet-bottles" draggable="true" data-name="Pet Bottles" data-pile="pile2">
            <img src="Images/Level 3/PET bottles.png" title="Pet Bottles">
        </div>
        <div class="waste" id="cosmetics" draggable="true" data-name="Cosmetics" data-pile="pile2">
            <img src="Images/Level 3/Cosmetics.png" title="Cosmetics">
        </div>
        <div class="waste" id="ldpe-cover" draggable="true" data-name="LDPE Cover" data-pile="pile2">
            <img src="Images/Level 3/LDPE Cover.png" title="LDPE Cover">
        </div>
        <div class="waste" id="plastic-medical" draggable="true" data-name="Plastic Medical" data-pile="pile2">
            <img src="Images/Level 3/Plastic medical waste.png" title="Plastic Medical">
        </div>

        <div class="waste" id="battery" draggable="true" data-name="Battery" data-pile="hazardous-pile">
            <img src="Images/Level 3/Battay.png" title="Battery">
        </div>
        <div class="waste" id="pesticides" draggable="true" data-name="Pesticides" data-pile="hazardous-pile">
            <img src="Images/Level 3/Pesticides and herbicides.png" title="Pesticides">
        </div>
        <div class="waste" id="e-waste" draggable="true" data-name="E-Waste" data-pile="hazardous-pile">
            <img src="Images/Level 3/E waste.png" title="E-Waste">
        </div>
        <div class="waste" id="chemicals" draggable="true" data-name="Chemicals" data-pile="hazardous-pile">
            <img src="Images/Level 3/Chemicals.png" title="Chemicals">
        </div>
    </div>
</div>

<div class="game-over-message" id="game-over-message">Level Complete! Congratulations!</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const wastes = document.querySelectorAll('.waste');
    const piles = document.querySelectorAll('.pile');
    const growthMarkers = document.querySelectorAll('.growth-marker');
    const gameOverMessage = document.getElementById('game-over-message');
    const pointsDisplay = document.getElementById('points');
    const timerDisplay = document.getElementById('timer');
    const tryAgainButton = document.getElementById('try-again-button');

    let gameCompleted = false;
    let points = 0;
    let timeLeft = 60; // 1 minute in seconds
    let penalties = {}; // Store penalties for wrongly sorted items

    // Start the timer
    const timerInterval = setInterval(updateTimer, 1000);

    // Update timer display every second
    function updateTimer() {
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timerDisplay.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

        if (timeLeft === 0) {
            clearInterval(timerInterval);
            endGame();
        }
    }

    wastes.forEach(waste => {
        waste.addEventListener('dragstart', dragStart);
        waste.addEventListener('dragend', dragEnd);
    });

    piles.forEach(pile => {
        pile.addEventListener('dragover', dragOver);
        pile.addEventListener('dragenter', dragEnter);
        pile.addEventListener('dragleave', dragLeave);
        pile.addEventListener('drop', drop);
    });

    function dragStart() {
        this.classList.add('dragging');
    }

    function dragEnd() {
        this.classList.remove('dragging');
        if (!gameCompleted) {
            checkPiles();
        }
    }

    function dragOver(e) {
        e.preventDefault();
    }

    function dragEnter(e) {
        e.preventDefault();
        this.classList.add('hovered');
    }

    function dragLeave() {
        this.classList.remove('hovered');
    }

    function drop(e) {
        if (gameCompleted) return;

        const draggedWaste = document.querySelector('.dragging');
        const correctPile = draggedWaste.dataset.pile;

        // Check if the dropped item belongs to the correct pile
        if (this.id === correctPile) {
            this.appendChild(draggedWaste);
            updateGrowthMarker(this.id); // Update growth marker for the correct pile
            points += 10; // Increase points for correct sorting
            pointsDisplay.textContent = `Points: ${points}`;
            if (penalties.hasOwnProperty(draggedWaste.id)) {
                delete penalties[draggedWaste.id]; // Reset penalty if item is sorted correctly
            }
        } else {
            if (!penalties.hasOwnProperty(draggedWaste.id)) {
                penalties[draggedWaste.id] = 10; // Set initial penalty if item is sorted wrongly for the first time
            } else {
                penalties[draggedWaste.id] += 10; // Increase penalty if item is sorted wrongly again
            }
            points -= penalties[draggedWaste.id]; // Decrease points for incorrect sorting
            pointsDisplay.textContent = `Points: ${points}`;
        }
    }

    function updateGrowthMarker(pileId) {
        const pileIndex = Array.from(piles).findIndex(pile => pile.id === pileId);
        const growthMarker = growthMarkers[pileIndex];
        growthMarker.style.height = parseInt(growthMarker.style.height || 0) + 20 + 'px';
    }

    function checkPiles() {
        const biofuels = ['wheat-straw', 'paper-waste', 'algea', 'food-waste'];
        const plastics = ['pet-bottles', 'cosmetics', 'ldpe-cover', 'plastic-medical'];
        const hazardousWastes = ['battery', 'pesticides', 'e-waste', 'chemicals'];

        const pile1Contents = Array.from(piles[0].children).map(child => child.id);
        const pile2Contents = Array.from(piles[1].children).map(child => child.id);
        const hazardousPileContents = Array.from(piles[2].children).map(child => child.id);

        const isBiofuelPileCorrect = biofuels.every(waste => pile1Contents.includes(waste));
        const isPlasticPileCorrect = plastics.every(waste => pile2Contents.includes(waste));
        const isHazardousPileCorrect = hazardousWastes.every(waste => hazardousPileContents.includes(waste));

        if (isBiofuelPileCorrect && isPlasticPileCorrect && isHazardousPileCorrect) {
            gameCompleted = true;
            showGameOverMessage();
            clearInterval(timerInterval); // Stop the timer when game is completed
        }
    }

    function showGameOverMessage() {
        gameOverMessage.style.display = 'block';
        tryAgainButton.style.display = 'block'; // Show the try again button
        tryAgainButton.addEventListener('click', tryAgain);
    }

    function tryAgain() {
        window.location.reload(); // Reload the page to restart the game
    }

    function endGame() {
        gameCompleted = true;
        clearInterval(timerInterval);
        gameOverMessage.textContent = 'Time Up! Try Again!';
        showGameOverMessage();
    }
});
</script>

</body>
</html>
